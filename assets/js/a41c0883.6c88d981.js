"use strict";(self.webpackChunkdocusaurus_tsx=self.webpackChunkdocusaurus_tsx||[]).push([[1795],{4583:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>a,toc:()=>d});var r=t(4848),s=t(8453);const o={},i="Translation WMT17 en-de",a={id:"recipes/wmt17/README",title:"Translation WMT17 en-de",description:"---",source:"@site/docs/recipes/wmt17/README.md",sourceDirName:"recipes/wmt17",slug:"/recipes/wmt17/",permalink:"/eole/docs/recipes/wmt17/",draft:!1,unlisted:!1,editUrl:"https://github.com/eole-nlp/eole/tree/main/docs/docs/recipes/wmt17/README.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Language Model Wiki-103",permalink:"/eole/docs/recipes/wiki_103/"},next:{title:"Contributors",permalink:"/eole/docs/contributing"}},c={},d=[{value:"<strong>NOTE</strong>\nTo make your life easier, run these commands from the recipe directory (here <code>recipes/wmt17</code>).",id:"noteto-make-your-life-easier-run-these-commands-from-the-recipe-directory-here-recipeswmt17",level:2},{value:"Get Data and prepare",id:"get-data-and-prepare",level:3},{value:"Train",id:"train",level:3}];function l(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",hr:"hr",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"translation-wmt17-en-de",children:"Translation WMT17 en-de"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h2,{id:"noteto-make-your-life-easier-run-these-commands-from-the-recipe-directory-here-recipeswmt17",children:[(0,r.jsx)(n.strong,{children:"NOTE"}),"\nTo make your life easier, run these commands from the recipe directory (here ",(0,r.jsx)(n.code,{children:"recipes/wmt17"}),")."]}),"\n",(0,r.jsx)(n.h3,{id:"get-data-and-prepare",children:"Get Data and prepare"}),"\n",(0,r.jsx)(n.p,{children:"WMT17 English-German data set:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd recipes/wmt17\nbash prepare_wmt_ende_data.sh\n"})}),"\n",(0,r.jsx)(n.h3,{id:"train",children:"Train"}),"\n",(0,r.jsx)(n.p,{children:"Training the following big transformer for 50K steps takes less than 10 hours on a single RTX 4090"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"eole build_vocab --config wmt17_ende.yaml --n_sample -1 # --num_threads 4\neole train --config wmt17_ende.yaml\n"})}),"\n",(0,r.jsx)(n.p,{children:"Translate test sets with various settings on local GPU and CPUs."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"eole predict --src wmt17_en_de/test.src.bpe --model_path wmt17_en_de/bigwmt17/step_50000 --beam_size 5 --batch_size 4096 --batch_type tokens --output wmt17_en_de/pred.trg.bpe --gpu 0\nsed -re 's/@@( |$)//g' < wmt17_en_de/pred.trg.bpe > wmt17_en_de/pred.trg.tok\nsacrebleu -tok none wmt17_en_de/test.trg < wmt17_en_de/pred.trg.tok\n"})}),"\n",(0,r.jsx)(n.p,{children:"BLEU scored at 40K, 45K, 50K steps on the test set (Newstest2016)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'{\n "name": "BLEU",\n "score": 35.4,\n "signature": "nrefs:1|case:mixed|eff:no|tok:none|smooth:exp|version:2.0.0",\n "verbose_score": "66.2/41.3/28.5/20.3 (BP = 0.998 ratio = 0.998 hyp_len = 64244 ref_len = 64379)",\n "nrefs": "1",\n "case": "mixed",\n "eff": "no",\n "tok": "none",\n "smooth": "exp",\n "version": "2.0.0"\n}\n{\n "name": "BLEU",\n "score": 35.2,\n "signature": "nrefs:1|case:mixed|eff:no|tok:none|smooth:exp|version:2.0.0",\n "verbose_score": "65.9/41.0/28.3/20.2 (BP = 1.000 ratio = 1.000 hyp_len = 64357 ref_len = 64379)",\n "nrefs": "1",\n "case": "mixed",\n "eff": "no",\n "tok": "none",\n "smooth": "exp",\n "version": "2.0.0"\n}\n{\n "name": "BLEU",\n "score": 35.1,\n "signature": "nrefs:1|case:mixed|eff:no|tok:none|smooth:exp|version:2.0.0",\n "verbose_score": "66.2/41.2/28.4/20.3 (BP = 0.992 ratio = 0.992 hyp_len = 63885 ref_len = 64379)",\n "nrefs": "1",\n "case": "mixed",\n "eff": "no",\n "tok": "none",\n "smooth": "exp",\n "version": "2.0.0"\n}\n\n'})})]})}function m(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>a});var r=t(6540);const s={},o=r.createContext(s);function i(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);