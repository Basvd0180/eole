"use strict";(self.webpackChunkdocusaurus_tsx=self.webpackChunkdocusaurus_tsx||[]).push([[7948],{3856:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>t,metadata:()=>o,toc:()=>c});var r=s(4848),l=s(8453);const t={},i="Prediction",o={id:"reference/Core API/inference",title:"Prediction",description:"Predictions",source:"@site/docs/reference/Core API/2_inference.md",sourceDirName:"reference/Core API",slug:"/reference/Core API/inference",permalink:"/eole/docs/reference/Core API/inference",draft:!1,unlisted:!1,editUrl:"https://github.com/eole-nlp/eole/tree/main/docs/docs/reference/Core API/2_inference.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{},sidebar:"apiSidebar",previous:{title:"Data Loaders",permalink:"/eole/docs/reference/Core API/dataloaders"},next:{title:"Bibliography",permalink:"/eole/docs/reference/bibliography"}},a={},c=[{value:"Predictions",id:"predictions",level:2},{value:"<em>class</em> eole.predict.prediction.Prediction(src, srclen, pred_sents, attn, pred_scores, estim, tgt_sent, gold_score, word_aligns, ind_in_bucket)[source]",id:"class-eolepredictpredictionpredictionsrc-srclen-pred_sents-attn-pred_scores-estim-tgt_sent-gold_score-word_aligns-ind_in_bucketsource",level:3},{value:"log(sent_number, src_raw=&#39;&#39;)[source]",id:"logsent_number-src_rawsource",level:4},{value:"<em>class</em> eole.predict.prediction.PredictionBuilder(vocabs, n_best=1, replace_unk=False, phrase_table=&#39;&#39;)[source]",id:"class-eolepredictpredictionpredictionbuildervocabs-n_best1-replace_unkfalse-phrase_tablesource",level:3},{value:"Predictor Classes",id:"predictor-classes",level:2},{value:"<em>class</em> eole.predict.inference.Inference(model, vocabs, gpu=-1, n_best=1, min_length=0, max_length=100, max_length_ratio=1.5, ratio=0.0, beam_size=30, random_sampling_topk=0, random_sampling_topp=0.0, random_sampling_temp=1.0, stepwise_penalty=None, dump_beam=False, block_ngram_repeat=0, ignore_when_blocking=frozenset({}), replace_unk=False, ban_unk_token=False, tgt_file_prefix=False, phrase_table=&#39;&#39;, data_type=&#39;text&#39;, verbose=False, report_time=False, global_scorer=None, out_file=None, report_align=False, gold_align=False, report_score=True, logger=None, seed=-1, with_score=False, return_gold_log_probs=False, add_estimator=False)[source]",id:"class-eolepredictinferenceinferencemodel-vocabs-gpu-1-n_best1-min_length0-max_length100-max_length_ratio15-ratio00-beam_size30-random_sampling_topk0-random_sampling_topp00-random_sampling_temp10-stepwise_penaltynone-dump_beamfalse-block_ngram_repeat0-ignore_when_blockingfrozenset-replace_unkfalse-ban_unk_tokenfalse-tgt_file_prefixfalse-phrase_table-data_typetext-verbosefalse-report_timefalse-global_scorernone-out_filenone-report_alignfalse-gold_alignfalse-report_scoretrue-loggernone-seed-1-with_scorefalse-return_gold_log_probsfalse-add_estimatorfalsesource",level:3},{value:"<em>classmethod</em> from_config(model, vocabs, config, model_config, global_scorer=None, out_file=None, report_align=False, report_score=True, logger=None)[source]",id:"classmethod-from_configmodel-vocabs-config-model_config-global_scorernone-out_filenone-report_alignfalse-report_scoretrue-loggernonesource",level:4},{value:"predict_batch(batch, attn_debug)[source]",id:"predict_batchbatch-attn_debugsource",level:4},{value:"<em>class</em> eole.predict.Translator(model, vocabs, gpu=-1, n_best=1, min_length=0, max_length=100, max_length_ratio=1.5, ratio=0.0, beam_size=30, random_sampling_topk=0, random_sampling_topp=0.0, random_sampling_temp=1.0, stepwise_penalty=None, dump_beam=False, block_ngram_repeat=0, ignore_when_blocking=frozenset({}), replace_unk=False, ban_unk_token=False, tgt_file_prefix=False, phrase_table=&#39;&#39;, data_type=&#39;text&#39;, verbose=False, report_time=False, global_scorer=None, out_file=None, report_align=False, gold_align=False, report_score=True, logger=None, seed=-1, with_score=False, return_gold_log_probs=False, add_estimator=False)[source]",id:"class-eolepredicttranslatormodel-vocabs-gpu-1-n_best1-min_length0-max_length100-max_length_ratio15-ratio00-beam_size30-random_sampling_topk0-random_sampling_topp00-random_sampling_temp10-stepwise_penaltynone-dump_beamfalse-block_ngram_repeat0-ignore_when_blockingfrozenset-replace_unkfalse-ban_unk_tokenfalse-tgt_file_prefixfalse-phrase_table-data_typetext-verbosefalse-report_timefalse-global_scorernone-out_filenone-report_alignfalse-gold_alignfalse-report_scoretrue-loggernone-seed-1-with_scorefalse-return_gold_log_probsfalse-add_estimatorfalsesource",level:3},{value:"predict_batch(batch, attn_debug)[source]",id:"predict_batchbatch-attn_debugsource-1",level:4},{value:"<em>class</em> eole.predict.GeneratorLM(model, vocabs, gpu=-1, n_best=1, min_length=0, max_length=100, max_length_ratio=1.5, ratio=0.0, beam_size=30, random_sampling_topk=0, random_sampling_topp=0.0, random_sampling_temp=1.0, stepwise_penalty=None, dump_beam=False, block_ngram_repeat=0, ignore_when_blocking=frozenset({}), replace_unk=False, ban_unk_token=False, tgt_file_prefix=False, phrase_table=&#39;&#39;, data_type=&#39;text&#39;, verbose=False, report_time=False, global_scorer=None, out_file=None, report_align=False, gold_align=False, report_score=True, logger=None, seed=-1, with_score=False, return_gold_log_probs=False, add_estimator=False)[source]",id:"class-eolepredictgeneratorlmmodel-vocabs-gpu-1-n_best1-min_length0-max_length100-max_length_ratio15-ratio00-beam_size30-random_sampling_topk0-random_sampling_topp00-random_sampling_temp10-stepwise_penaltynone-dump_beamfalse-block_ngram_repeat0-ignore_when_blockingfrozenset-replace_unkfalse-ban_unk_tokenfalse-tgt_file_prefixfalse-phrase_table-data_typetext-verbosefalse-report_timefalse-global_scorernone-out_filenone-report_alignfalse-gold_alignfalse-report_scoretrue-loggernone-seed-1-with_scorefalse-return_gold_log_probsfalse-add_estimatorfalsesource",level:3},{value:"predict_batch(batch, attn_debug, scoring=False)[source]",id:"predict_batchbatch-attn_debug-scoringfalsesource",level:4},{value:"<em>class</em> eole.predict.Encoder(model, vocabs, gpu=-1, n_best=1, min_length=0, max_length=100, max_length_ratio=1.5, ratio=0.0, beam_size=30, random_sampling_topk=0, random_sampling_topp=0.0, random_sampling_temp=1.0, stepwise_penalty=None, dump_beam=False, block_ngram_repeat=0, ignore_when_blocking=frozenset({}), replace_unk=False, ban_unk_token=False, tgt_file_prefix=False, phrase_table=&#39;&#39;, data_type=&#39;text&#39;, verbose=False, report_time=False, global_scorer=None, out_file=None, report_align=False, gold_align=False, report_score=True, logger=None, seed=-1, with_score=False, return_gold_log_probs=False, add_estimator=False)[source]",id:"class-eolepredictencodermodel-vocabs-gpu-1-n_best1-min_length0-max_length100-max_length_ratio15-ratio00-beam_size30-random_sampling_topk0-random_sampling_topp00-random_sampling_temp10-stepwise_penaltynone-dump_beamfalse-block_ngram_repeat0-ignore_when_blockingfrozenset-replace_unkfalse-ban_unk_tokenfalse-tgt_file_prefixfalse-phrase_table-data_typetext-verbosefalse-report_timefalse-global_scorernone-out_filenone-report_alignfalse-gold_alignfalse-report_scoretrue-loggernone-seed-1-with_scorefalse-return_gold_log_probsfalse-add_estimatorfalsesource",level:3},{value:"predict_batch(batch, attn_debug)[source]",id:"predict_batchbatch-attn_debugsource-2",level:4},{value:"Decoding Strategies",id:"decoding-strategies",level:2},{value:"<em>class</em> eole.predict.DecodeStrategy(pad, bos, eos, unk, start, batch_size, parallel_paths, global_scorer, min_length, block_ngram_repeat, exclusion_tokens, return_attention, max_length, ban_unk_token, add_estimator)[source]",id:"class-eolepredictdecodestrategypad-bos-eos-unk-start-batch_size-parallel_paths-global_scorer-min_length-block_ngram_repeat-exclusion_tokens-return_attention-max_length-ban_unk_token-add_estimatorsource",level:3},{value:"advance(log_probs, attn)[source]",id:"advancelog_probs-attnsource",level:4},{value:"block_ngram_repeats(log_probs)[source]",id:"block_ngram_repeatslog_probssource",level:4},{value:"initialize(device=None, target_prefix=None)[source]",id:"initializedevicenone-target_prefixnonesource",level:4},{value:"maybe_update_forbidden_tokens()[source]",id:"maybe_update_forbidden_tokenssource",level:4},{value:"maybe_update_target_prefix(select_index)[source]",id:"maybe_update_target_prefixselect_indexsource",level:4},{value:"target_prefixing(log_probs)[source]",id:"target_prefixinglog_probssource",level:4},{value:"update_finished()[source]",id:"update_finishedsource",level:4},{value:"<em>class</em> eole.predict.BeamSearch(beam_size, batch_size, pad, bos, eos, unk, start, n_best, global_scorer, min_length, max_length, return_attention, block_ngram_repeat, exclusion_tokens, stepwise_penalty, ratio, ban_unk_token, add_estimator=False)[source]",id:"class-eolepredictbeamsearchbeam_size-batch_size-pad-bos-eos-unk-start-n_best-global_scorer-min_length-max_length-return_attention-block_ngram_repeat-exclusion_tokens-stepwise_penalty-ratio-ban_unk_token-add_estimatorfalsesource",level:3},{value:"initialize(enc_out, src_len, device=None, target_prefix=None)[source]",id:"initializeenc_out-src_len-devicenone-target_prefixnonesource",level:4},{value:"eole.predict.greedy_search.sample_with_temperature(logits, sampling_temp, keep_topk, keep_topp)[source]",id:"eolepredictgreedy_searchsample_with_temperaturelogits-sampling_temp-keep_topk-keep_toppsource",level:3},{value:"<em>class</em> eole.predict.GreedySearch(pad, bos, eos, unk, start, n_best, batch_size, global_scorer, min_length, block_ngram_repeat, exclusion_tokens, return_attention, max_length, sampling_temp, keep_topk, keep_topp, beam_size, ban_unk_token, add_estimator=False)[source]",id:"class-eolepredictgreedysearchpad-bos-eos-unk-start-n_best-batch_size-global_scorer-min_length-block_ngram_repeat-exclusion_tokens-return_attention-max_length-sampling_temp-keep_topk-keep_topp-beam_size-ban_unk_token-add_estimatorfalsesource",level:3},{value:"advance(log_probs, attn)[source]",id:"advancelog_probs-attnsource-1",level:4},{value:"initialize(enc_out, src_len, device=None, target_prefix=None)[source]",id:"initializeenc_out-src_len-devicenone-target_prefixnonesource-1",level:4},{value:"update_finished()[source]",id:"update_finishedsource-1",level:4},{value:"Scoring",id:"scoring",level:2},{value:"<em>class</em> eole.predict.penalties.PenaltyBuilder(cov_pen, length_pen)[source]",id:"class-eolepredictpenaltiespenaltybuildercov_pen-length_pensource",level:3},{value:"coverage_none(cov, beta=0.0)[source]",id:"coverage_nonecov-beta00source",level:4},{value:"coverage_summary(cov, beta=0.0)[source]",id:"coverage_summarycov-beta00source",level:4},{value:"coverage_wu(cov, beta=0.0)[source]",id:"coverage_wucov-beta00source",level:4},{value:"length_average(cur_len, alpha=1.0)[source]",id:"length_averagecur_len-alpha10source",level:4},{value:"length_none(cur_len, alpha=0.0)[source]",id:"length_nonecur_len-alpha00source",level:4},{value:"length_wu(cur_len, alpha=0.0)[source]",id:"length_wucur_len-alpha00source",level:4},{value:"<em>class</em> eole.predict.GNMTGlobalScorer(alpha, beta, length_penalty, coverage_penalty)[source]",id:"class-eolepredictgnmtglobalscoreralpha-beta-length_penalty-coverage_penaltysource",level:3}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"prediction",children:"Prediction"}),"\n",(0,r.jsx)(n.h2,{id:"predictions",children:"Predictions"}),"\n",(0,r.jsxs)(n.h3,{id:"class-eolepredictpredictionpredictionsrc-srclen-pred_sents-attn-pred_scores-estim-tgt_sent-gold_score-word_aligns-ind_in_bucketsource",children:[(0,r.jsx)(n.em,{children:"class"})," eole.predict.prediction.Prediction(src, srclen, pred_sents, attn, pred_scores, estim, tgt_sent, gold_score, word_aligns, ind_in_bucket)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/prediction.py#L139-L222",children:"[source]"})]}),"\n",(0,r.jsxs)(n.p,{children:["Bases: ",(0,r.jsx)(n.code,{children:"object"})]}),"\n",(0,r.jsx)(n.p,{children:"Container for a predicted sentence."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Variables:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"src"})," (",(0,r.jsx)(n.em,{children:"LongTensor"}),") \u2013 Source word IDs."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"srclen"})," (",(0,r.jsx)(n.em,{children:"List"})," *[*",(0,r.jsx)(n.em,{children:"int"})," ",(0,r.jsx)(n.em,{children:"]"}),") \u2013 Source lengths."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"pred_sents"})," (",(0,r.jsx)(n.em,{children:"List"})," *[*",(0,r.jsx)(n.em,{children:"List"})," *[*",(0,r.jsx)(n.em,{children:"str"})," ",(0,r.jsx)(n.em,{children:"]"})," ",(0,r.jsx)(n.em,{children:"]"}),") \u2013 Words from the n-best predictions."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"pred_scores"})," (",(0,r.jsx)(n.em,{children:"List"})," *[*",(0,r.jsx)(n.em,{children:"List"})," *[*",(0,r.jsx)(n.em,{children:"float"})," ",(0,r.jsx)(n.em,{children:"]"})," ",(0,r.jsx)(n.em,{children:"]"}),") \u2013 Log-probs of n-best predictions."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"attns"})," (",(0,r.jsx)(n.em,{children:"List"})," *[*",(0,r.jsx)(n.em,{children:"FloatTensor"})," ",(0,r.jsx)(n.em,{children:"]"}),") \u2013 Attention distribution for each\nprediction."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"gold_sent"})," (",(0,r.jsx)(n.em,{children:"List"})," *[*",(0,r.jsx)(n.em,{children:"str"})," ",(0,r.jsx)(n.em,{children:"]"}),") \u2013 Words from gold prediction."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"gold_score"})," (",(0,r.jsx)(n.em,{children:"List"})," *[*",(0,r.jsx)(n.em,{children:"float"})," ",(0,r.jsx)(n.em,{children:"]"}),") \u2013 Log-prob of gold prediction."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"word_aligns"})," (",(0,r.jsx)(n.em,{children:"List"})," *[*",(0,r.jsx)(n.em,{children:"FloatTensor"})," ",(0,r.jsx)(n.em,{children:"]"}),") \u2013 Words Alignment distribution for\neach prediction."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"logsent_number-src_rawsource",children:["log(sent_number, src_raw='')",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/prediction.py#L192-L222",children:"[source]"})]}),"\n",(0,r.jsx)(n.p,{children:"Log prediction."}),"\n",(0,r.jsxs)(n.h3,{id:"class-eolepredictpredictionpredictionbuildervocabs-n_best1-replace_unkfalse-phrase_tablesource",children:[(0,r.jsx)(n.em,{children:"class"})," eole.predict.prediction.PredictionBuilder(vocabs, n_best=1, replace_unk=False, phrase_table='')",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/prediction.py#L7-L136",children:"[source]"})]}),"\n",(0,r.jsxs)(n.p,{children:["Bases: ",(0,r.jsx)(n.code,{children:"object"})]}),"\n",(0,r.jsx)(n.p,{children:"Build a word-based prediction from the batch output\nof predictor and the underlying dictionaries."}),"\n",(0,r.jsx)(n.p,{children:"Replacement based on \u201cAddressing the Rare Word\nProblem in Neural Machine Translation\u201d []"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameters:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"(****)"})," (",(0,r.jsx)(n.em,{children:"vocabs"}),")"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"(****)"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"n_best"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 number of predictions produced"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"replace_unk"})," (",(0,r.jsx)(n.em,{children:"bool"}),") \u2013 replace unknown words using attention"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"predictor-classes",children:"Predictor Classes"}),"\n",(0,r.jsxs)(n.h3,{id:"class-eolepredictinferenceinferencemodel-vocabs-gpu-1-n_best1-min_length0-max_length100-max_length_ratio15-ratio00-beam_size30-random_sampling_topk0-random_sampling_topp00-random_sampling_temp10-stepwise_penaltynone-dump_beamfalse-block_ngram_repeat0-ignore_when_blockingfrozenset-replace_unkfalse-ban_unk_tokenfalse-tgt_file_prefixfalse-phrase_table-data_typetext-verbosefalse-report_timefalse-global_scorernone-out_filenone-report_alignfalse-gold_alignfalse-report_scoretrue-loggernone-seed-1-with_scorefalse-return_gold_log_probsfalse-add_estimatorfalsesource",children:[(0,r.jsx)(n.em,{children:"class"})," eole.predict.inference.Inference(model, vocabs, gpu=-1, n_best=1, min_length=0, max_length=100, max_length_ratio=1.5, ratio=0.0, beam_size=30, random_sampling_topk=0, random_sampling_topp=0.0, random_sampling_temp=1.0, stepwise_penalty=None, dump_beam=False, block_ngram_repeat=0, ignore_when_blocking=frozenset({}), replace_unk=False, ban_unk_token=False, tgt_file_prefix=False, phrase_table='', data_type='text', verbose=False, report_time=False, global_scorer=None, out_file=None, report_align=False, gold_align=False, report_score=True, logger=None, seed=-1, with_score=False, return_gold_log_probs=False, add_estimator=False)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/inference.py#L17-L741",children:"[source]"})]}),"\n",(0,r.jsxs)(n.p,{children:["Bases: ",(0,r.jsx)(n.code,{children:"object"})]}),"\n",(0,r.jsx)(n.p,{children:"Predict a batch of sentences with a saved model."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameters:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"model"})," (",(0,r.jsx)(n.em,{children:"eole.modules.BaseModel"}),") \u2013 Model to use for prediction"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"vocabs"})," (",(0,r.jsx)(n.em,{children:"dict"})," *[*",(0,r.jsx)(n.em,{children:"str"})," ",(0,r.jsx)(n.em,{children:","})," ",(0,r.jsx)(n.em,{children:"Vocab"})," ",(0,r.jsx)(n.em,{children:"]"}),") \u2013 A dict\nmapping each side\u2019s Vocab."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"gpu"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 GPU device. Set to negative for no GPU."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"n_best"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 How many beams to wait for."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"min_length"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See\n",(0,r.jsx)(n.a,{href:"#eole.predict.DecodeStrategy",children:(0,r.jsx)(n.code,{children:"eole.predict.decode_strategy.DecodeStrategy"})}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"max_length"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See\n",(0,r.jsx)(n.a,{href:"#eole.predict.DecodeStrategy",children:(0,r.jsx)(n.code,{children:"eole.predict.decode_strategy.DecodeStrategy"})}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"beam_size"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 Number of beams."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"random_sampling_topk"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See\n",(0,r.jsx)(n.a,{href:"#eole.predict.GreedySearch",children:(0,r.jsx)(n.code,{children:"eole.predict.greedy_search.GreedySearch"})}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"random_sampling_temp"})," (",(0,r.jsx)(n.em,{children:"float"}),") \u2013 See\n",(0,r.jsx)(n.a,{href:"#eole.predict.GreedySearch",children:(0,r.jsx)(n.code,{children:"eole.predict.greedy_search.GreedySearch"})}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"stepwise_penalty"})," (",(0,r.jsx)(n.em,{children:"bool"}),") \u2013 Whether coverage penalty is applied every step\nor not."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"dump_beam"})," (",(0,r.jsx)(n.em,{children:"bool"}),") \u2013 Debugging option."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"block_ngram_repeat"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See\n",(0,r.jsx)(n.a,{href:"#eole.predict.DecodeStrategy",children:(0,r.jsx)(n.code,{children:"eole.predict.decode_strategy.DecodeStrategy"})}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ignore_when_blocking"})," (",(0,r.jsx)(n.em,{children:"set"})," ",(0,r.jsx)(n.em,{children:"or"})," ",(0,r.jsx)(n.em,{children:"frozenset"}),") \u2013 See\n",(0,r.jsx)(n.a,{href:"#eole.predict.DecodeStrategy",children:(0,r.jsx)(n.code,{children:"eole.predict.decode_strategy.DecodeStrategy"})}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"replace_unk"})," (",(0,r.jsx)(n.em,{children:"bool"}),") \u2013 Replace unknown token."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"tgt_file_prefix"})," (",(0,r.jsx)(n.em,{children:"bool"}),") \u2013 Force the predictions begin with provided -tgt."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"data_type"})," (",(0,r.jsx)(n.em,{children:"str"}),") \u2013 Source data type."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"verbose"})," (",(0,r.jsx)(n.em,{children:"bool"}),") \u2013 Print/log every prediction."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"report_time"})," (",(0,r.jsx)(n.em,{children:"bool"}),") \u2013 Print/log total time/frequency."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"global_scorer"})," (",(0,r.jsx)(n.a,{href:"#eole.predict.GNMTGlobalScorer",children:(0,r.jsx)(n.em,{children:"eole.predict.GNMTGlobalScorer"})}),") \u2013 Prediction\nscoring/reranking object."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"out_file"})," (",(0,r.jsx)(n.em,{children:"TextIO"})," ",(0,r.jsx)(n.em,{children:"or"})," ",(0,r.jsx)(n.em,{children:"codecs.StreamReaderWriter"}),") \u2013 Output file."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"report_score"})," (",(0,r.jsx)(n.em,{children:"bool"}),") \u2013 Whether to report scores"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"logger"})," (",(0,r.jsx)(n.em,{children:"logging.Logger"})," ",(0,r.jsx)(n.em,{children:"or"})," ",(0,r.jsx)(n.em,{children:"NoneType"}),") \u2013 Logger."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"classmethod-from_configmodel-vocabs-config-model_config-global_scorernone-out_filenone-report_alignfalse-report_scoretrue-loggernonesource",children:[(0,r.jsx)(n.em,{children:"classmethod"})," from_config(model, vocabs, config, model_config, global_scorer=None, out_file=None, report_align=False, report_score=True, logger=None)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/inference.py#L162-L227",children:"[source]"})]}),"\n",(0,r.jsx)(n.p,{children:"Alternate constructor."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameters:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"model"})," (",(0,r.jsx)(n.em,{children:"eole.modules.BaseModel"}),") \u2013 See ",(0,r.jsx)(n.code,{children:"__init__()"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"vocabs"})," (",(0,r.jsx)(n.em,{children:"dict"})," *[*",(0,r.jsx)(n.em,{children:"str"})," ",(0,r.jsx)(n.em,{children:","})," ",(0,r.jsx)(n.em,{children:"Vocab"})," ",(0,r.jsx)(n.em,{children:"]"}),") \u2013 See\n",(0,r.jsx)(n.code,{children:"__init__()"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"opt"})," (",(0,r.jsx)(n.em,{children:"argparse.Namespace"}),") \u2013 Command line options"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"model_opt"})," (",(0,r.jsx)(n.em,{children:"argparse.Namespace"}),") \u2013 Command line options saved with\nthe model checkpoint."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"global_scorer"})," (",(0,r.jsx)(n.a,{href:"#eole.predict.GNMTGlobalScorer",children:(0,r.jsx)(n.em,{children:"eole.predict.GNMTGlobalScorer"})}),") \u2013 See\n",(0,r.jsx)(n.code,{children:"__init__()"}),".."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"out_file"})," (",(0,r.jsx)(n.em,{children:"TextIO"})," ",(0,r.jsx)(n.em,{children:"or"})," ",(0,r.jsx)(n.em,{children:"codecs.StreamReaderWriter"}),") \u2013 See\n",(0,r.jsx)(n.code,{children:"__init__()"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"report_align"})," (",(0,r.jsx)(n.em,{children:"bool"}),") \u2013 See ",(0,r.jsx)(n.code,{children:"__init__()"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"report_score"})," (",(0,r.jsx)(n.em,{children:"bool"}),") \u2013 See ",(0,r.jsx)(n.code,{children:"__init__()"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"logger"})," (",(0,r.jsx)(n.em,{children:"logging.Logger"})," ",(0,r.jsx)(n.em,{children:"or"})," ",(0,r.jsx)(n.em,{children:"NoneType"}),") \u2013 See ",(0,r.jsx)(n.code,{children:"__init__()"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"predict_batchbatch-attn_debugsource",children:["predict_batch(batch, attn_debug)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/inference.py#L684-L686",children:"[source]"})]}),"\n",(0,r.jsx)(n.p,{children:"Predict a batch of sentences."}),"\n",(0,r.jsxs)(n.h3,{id:"class-eolepredicttranslatormodel-vocabs-gpu-1-n_best1-min_length0-max_length100-max_length_ratio15-ratio00-beam_size30-random_sampling_topk0-random_sampling_topp00-random_sampling_temp10-stepwise_penaltynone-dump_beamfalse-block_ngram_repeat0-ignore_when_blockingfrozenset-replace_unkfalse-ban_unk_tokenfalse-tgt_file_prefixfalse-phrase_table-data_typetext-verbosefalse-report_timefalse-global_scorernone-out_filenone-report_alignfalse-gold_alignfalse-report_scoretrue-loggernone-seed-1-with_scorefalse-return_gold_log_probsfalse-add_estimatorfalsesource",children:[(0,r.jsx)(n.em,{children:"class"})," eole.predict.Translator(model, vocabs, gpu=-1, n_best=1, min_length=0, max_length=100, max_length_ratio=1.5, ratio=0.0, beam_size=30, random_sampling_topk=0, random_sampling_topp=0.0, random_sampling_temp=1.0, stepwise_penalty=None, dump_beam=False, block_ngram_repeat=0, ignore_when_blocking=frozenset({}), replace_unk=False, ban_unk_token=False, tgt_file_prefix=False, phrase_table='', data_type='text', verbose=False, report_time=False, global_scorer=None, out_file=None, report_align=False, gold_align=False, report_score=True, logger=None, seed=-1, with_score=False, return_gold_log_probs=False, add_estimator=False)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/translator.py#L12-L290",children:"[source]"})]}),"\n",(0,r.jsxs)(n.p,{children:["Bases: ",(0,r.jsx)(n.a,{href:"#eole.predict.inference.Inference",children:(0,r.jsx)(n.code,{children:"Inference"})})]}),"\n",(0,r.jsxs)(n.h4,{id:"predict_batchbatch-attn_debugsource-1",children:["predict_batch(batch, attn_debug)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/translator.py#L68-L121",children:"[source]"})]}),"\n",(0,r.jsx)(n.p,{children:"Translate a batch of sentences."}),"\n",(0,r.jsxs)(n.h3,{id:"class-eolepredictgeneratorlmmodel-vocabs-gpu-1-n_best1-min_length0-max_length100-max_length_ratio15-ratio00-beam_size30-random_sampling_topk0-random_sampling_topp00-random_sampling_temp10-stepwise_penaltynone-dump_beamfalse-block_ngram_repeat0-ignore_when_blockingfrozenset-replace_unkfalse-ban_unk_tokenfalse-tgt_file_prefixfalse-phrase_table-data_typetext-verbosefalse-report_timefalse-global_scorernone-out_filenone-report_alignfalse-gold_alignfalse-report_scoretrue-loggernone-seed-1-with_scorefalse-return_gold_log_probsfalse-add_estimatorfalsesource",children:[(0,r.jsx)(n.em,{children:"class"})," eole.predict.GeneratorLM(model, vocabs, gpu=-1, n_best=1, min_length=0, max_length=100, max_length_ratio=1.5, ratio=0.0, beam_size=30, random_sampling_topk=0, random_sampling_topp=0.0, random_sampling_temp=1.0, stepwise_penalty=None, dump_beam=False, block_ngram_repeat=0, ignore_when_blocking=frozenset({}), replace_unk=False, ban_unk_token=False, tgt_file_prefix=False, phrase_table='', data_type='text', verbose=False, report_time=False, global_scorer=None, out_file=None, report_align=False, gold_align=False, report_score=True, logger=None, seed=-1, with_score=False, return_gold_log_probs=False, add_estimator=False)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/generator.py#L8-L195",children:"[source]"})]}),"\n",(0,r.jsxs)(n.p,{children:["Bases: ",(0,r.jsx)(n.a,{href:"#eole.predict.inference.Inference",children:(0,r.jsx)(n.code,{children:"Inference"})})]}),"\n",(0,r.jsxs)(n.h4,{id:"predict_batchbatch-attn_debug-scoringfalsesource",children:["predict_batch(batch, attn_debug, scoring=False)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/generator.py#L24-L71",children:"[source]"})]}),"\n",(0,r.jsx)(n.p,{children:"Predict a batch of sentences."}),"\n",(0,r.jsxs)(n.h3,{id:"class-eolepredictencodermodel-vocabs-gpu-1-n_best1-min_length0-max_length100-max_length_ratio15-ratio00-beam_size30-random_sampling_topk0-random_sampling_topp00-random_sampling_temp10-stepwise_penaltynone-dump_beamfalse-block_ngram_repeat0-ignore_when_blockingfrozenset-replace_unkfalse-ban_unk_tokenfalse-tgt_file_prefixfalse-phrase_table-data_typetext-verbosefalse-report_timefalse-global_scorernone-out_filenone-report_alignfalse-gold_alignfalse-report_scoretrue-loggernone-seed-1-with_scorefalse-return_gold_log_probsfalse-add_estimatorfalsesource",children:[(0,r.jsx)(n.em,{children:"class"})," eole.predict.Encoder(model, vocabs, gpu=-1, n_best=1, min_length=0, max_length=100, max_length_ratio=1.5, ratio=0.0, beam_size=30, random_sampling_topk=0, random_sampling_topp=0.0, random_sampling_temp=1.0, stepwise_penalty=None, dump_beam=False, block_ngram_repeat=0, ignore_when_blocking=frozenset({}), replace_unk=False, ban_unk_token=False, tgt_file_prefix=False, phrase_table='', data_type='text', verbose=False, report_time=False, global_scorer=None, out_file=None, report_align=False, gold_align=False, report_score=True, logger=None, seed=-1, with_score=False, return_gold_log_probs=False, add_estimator=False)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/encoder.py#L9-L157",children:"[source]"})]}),"\n",(0,r.jsxs)(n.p,{children:["Bases: ",(0,r.jsx)(n.a,{href:"#eole.predict.inference.Inference",children:(0,r.jsx)(n.code,{children:"Inference"})})]}),"\n",(0,r.jsxs)(n.h4,{id:"predict_batchbatch-attn_debugsource-2",children:["predict_batch(batch, attn_debug)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/encoder.py#L18-L70",children:"[source]"})]}),"\n",(0,r.jsx)(n.p,{children:"Predict a batch of sentences."}),"\n",(0,r.jsx)(n.h2,{id:"decoding-strategies",children:"Decoding Strategies"}),"\n",(0,r.jsxs)(n.h3,{id:"class-eolepredictdecodestrategypad-bos-eos-unk-start-batch_size-parallel_paths-global_scorer-min_length-block_ngram_repeat-exclusion_tokens-return_attention-max_length-ban_unk_token-add_estimatorsource",children:[(0,r.jsx)(n.em,{children:"class"})," eole.predict.DecodeStrategy(pad, bos, eos, unk, start, batch_size, parallel_paths, global_scorer, min_length, block_ngram_repeat, exclusion_tokens, return_attention, max_length, ban_unk_token, add_estimator)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/decode_strategy.py#L7-L336",children:"[source]"})]}),"\n",(0,r.jsxs)(n.p,{children:["Bases: ",(0,r.jsx)(n.code,{children:"object"})]}),"\n",(0,r.jsx)(n.p,{children:"Base class for generation strategies."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameters:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"pad"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 Magic integer in output vocab."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"bos"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 Magic integer in output vocab."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"eos"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 Magic integer in output vocab."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"unk"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 Magic integer in output vocab."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"start"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 Magic integer in output vocab."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"batch_size"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 Current batch size."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"parallel_paths"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 Decoding strategies like beam search\nuse parallel paths. Each batch is repeated ",(0,r.jsx)(n.code,{children:"parallel_paths"}),"\ntimes in relevant state tensors."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"min_length"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 Shortest acceptable generation, not counting\nbegin-of-sentence or end-of-sentence."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"max_length"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 Longest acceptable sequence, not counting\nbegin-of-sentence (presumably there has been no EOS\nyet if max_length is used as a cutoff)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ban_unk_token"})," (",(0,r.jsx)(n.em,{children:"Boolean"}),") \u2013 Whether unk token is forbidden"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"block_ngram_repeat"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 Block beams where\n",(0,r.jsx)(n.code,{children:"block_ngram_repeat"}),"-grams repeat."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"exclusion_tokens"})," (",(0,r.jsx)(n.em,{children:"set"})," *[*",(0,r.jsx)(n.em,{children:"int"})," ",(0,r.jsx)(n.em,{children:"]"}),") \u2013 If a gram contains any of these\ntokens, it may repeat."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"return_attention"})," (",(0,r.jsx)(n.em,{children:"bool"}),") \u2013 Whether to work with attention too. If this\nis true, it is assumed that the decoder is attentional."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Variables:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"pad"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See above."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"bos"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See above."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"eos"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See above."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"unk"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See above."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"start"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See above."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"predictions"})," (",(0,r.jsx)(n.em,{children:"list"})," *[*",(0,r.jsx)(n.em,{children:"list"})," *[*",(0,r.jsx)(n.em,{children:"LongTensor"})," ",(0,r.jsx)(n.em,{children:"]"})," ",(0,r.jsx)(n.em,{children:"]"}),") \u2013 For each batch, holds a\nlist of beam prediction sequences.\nscores (list[list[FloatTensor]]): For each batch, holds a\nlist of scores."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"attention"})," (",(0,r.jsx)(n.em,{children:"list"})," *[*",(0,r.jsx)(n.em,{children:"list"})," *[*",(0,r.jsx)(n.em,{children:"FloatTensor"})," ",(0,r.jsx)(n.em,{children:"or"})," ",(0,r.jsx)(n.em,{children:"list"})," ",(0,r.jsx)(n.em,{children:"["})," ",(0,r.jsx)(n.em,{children:"]"})," ",(0,r.jsx)(n.em,{children:"]"})," ",(0,r.jsx)(n.em,{children:"]"}),") \u2013 For each\nbatch, holds a list of attention sequence tensors\n(or empty lists) having shape ",(0,r.jsx)(n.code,{children:"(step, inp_seq_len)"})," where\n",(0,r.jsx)(n.code,{children:"inp_seq_len"})," is the length of the sample (not the max\nlength of all inp seqs)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"alive_seq"})," (",(0,r.jsx)(n.em,{children:"LongTensor"}),") \u2013 Shape ",(0,r.jsx)(n.code,{children:"(B x parallel_paths, step)"}),".\nThis sequence grows in the ",(0,r.jsx)(n.code,{children:"step"})," axis on each call to\n:func:",(0,r.jsx)(n.code,{children:"advance()"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"is_finished"})," (",(0,r.jsx)(n.em,{children:"ByteTensor"})," ",(0,r.jsx)(n.em,{children:"or"})," ",(0,r.jsx)(n.em,{children:"NoneType"}),") \u2013 Shape ",(0,r.jsx)(n.code,{children:"(B, parallel_paths)"}),".\nInitialized to ",(0,r.jsx)(n.code,{children:"None"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"alive_attn"})," (",(0,r.jsx)(n.em,{children:"FloatTensor"})," ",(0,r.jsx)(n.em,{children:"or"})," ",(0,r.jsx)(n.em,{children:"NoneType"}),") \u2013 If tensor, shape is\n",(0,r.jsx)(n.code,{children:"(B x parallel_paths, step, inp_seq_len)"}),", where ",(0,r.jsx)(n.code,{children:"inp_seq_len"}),"\nis the (max) length of the input sequence."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"target_prefix"})," (",(0,r.jsx)(n.em,{children:"LongTensor"})," ",(0,r.jsx)(n.em,{children:"or"})," ",(0,r.jsx)(n.em,{children:"NoneType"}),") \u2013 If tensor, shape is\n",(0,r.jsx)(n.code,{children:"(B x parallel_paths, prefix_seq_len)"}),", where ",(0,r.jsx)(n.code,{children:"prefix_seq_len"}),"\nis the (max) length of the pre-fixed prediction."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"min_length"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See above."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"max_length"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See above."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ban_unk_token"})," (",(0,r.jsx)(n.em,{children:"Boolean"}),") \u2013 See above."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"block_ngram_repeat"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See above."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"exclusion_tokens"})," (",(0,r.jsx)(n.em,{children:"set"})," *[*",(0,r.jsx)(n.em,{children:"int"})," ",(0,r.jsx)(n.em,{children:"]"}),") \u2013 See above."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"return_attention"})," (",(0,r.jsx)(n.em,{children:"bool"}),") \u2013 See above."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"done"})," (",(0,r.jsx)(n.em,{children:"bool"}),") \u2013 See above."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"advancelog_probs-attnsource",children:["advance(log_probs, attn)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/decode_strategy.py#L320-L327",children:"[source]"})]}),"\n",(0,r.jsxs)(n.p,{children:["DecodeStrategy subclasses should override ",(0,r.jsx)(n.a,{href:"#eole.predict.DecodeStrategy.advance",children:(0,r.jsx)(n.code,{children:"advance()"})}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Advance is used to update ",(0,r.jsx)(n.code,{children:"self.alive_seq"}),", ",(0,r.jsx)(n.code,{children:"self.is_finished"}),",\nand, when appropriate, ",(0,r.jsx)(n.code,{children:"self.alive_attn"}),"."]}),"\n",(0,r.jsxs)(n.h4,{id:"block_ngram_repeatslog_probssource",children:["block_ngram_repeats(log_probs)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/decode_strategy.py#L199-L232",children:"[source]"})]}),"\n",(0,r.jsx)(n.p,{children:"We prevent the beam from going in any direction that would repeat\nany ngram of size <block_ngram_repeat> more thant once."}),"\n",(0,r.jsx)(n.p,{children:"The way we do it: we maintain a list of all ngrams of size\n<block_ngram_repeat> that is updated each time the beam advances, and\nmanually put any token that would lead to a repeated ngram to 0."}),"\n",(0,r.jsx)(n.p,{children:"This improves on the previous version\u2019s complexity:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"previous version\u2019s complexity: batch_size * beam_size * len(self)"}),"\n",(0,r.jsx)(n.li,{children:"current version\u2019s complexity: batch_size * beam_size"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This improves on the previous version\u2019s accuracy;"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Previous version blocks the whole beam, whereas here we only\nblock specific tokens."}),"\n",(0,r.jsx)(n.li,{children:"Before the prediction would fail when all beams contained\nrepeated ngrams. This is sure to never happen here."}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"initializedevicenone-target_prefixnonesource",children:["initialize(device=None, target_prefix=None)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/decode_strategy.py#L140-L176",children:"[source]"})]}),"\n",(0,r.jsxs)(n.p,{children:["DecodeStrategy subclasses should override ",(0,r.jsx)(n.a,{href:"#eole.predict.DecodeStrategy.initialize",children:(0,r.jsx)(n.code,{children:"initialize()"})}),"."]}),"\n",(0,r.jsx)(n.p,{children:"initialize should be called before all actions.\nused to prepare necessary ingredients for decode."}),"\n",(0,r.jsxs)(n.h4,{id:"maybe_update_forbidden_tokenssource",children:["maybe_update_forbidden_tokens()",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/decode_strategy.py#L234-L263",children:"[source]"})]}),"\n",(0,r.jsx)(n.p,{children:"We complete and reorder the list of forbidden_tokens"}),"\n",(0,r.jsxs)(n.h4,{id:"maybe_update_target_prefixselect_indexsource",children:["maybe_update_target_prefix(select_index)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/decode_strategy.py#L310-L318",children:"[source]"})]}),"\n",(0,r.jsx)(n.p,{children:"We update / reorder target_prefix for alive path."}),"\n",(0,r.jsxs)(n.h4,{id:"target_prefixinglog_probssource",children:["target_prefixing(log_probs)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/decode_strategy.py#L265-L308",children:"[source]"})]}),"\n",(0,r.jsx)(n.p,{children:"Fix the first part of predictions with self.target_prefix."}),"\n",(0,r.jsxs)(n.p,{children:["Args:\nlog_probs (FloatTensor): logits of size ",(0,r.jsx)(n.code,{children:"(B, vocab_size)"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Returns:\nlog_probs (FloatTensor): modified logits in ",(0,r.jsx)(n.code,{children:"(B, vocab_size)"}),"."]}),"\n",(0,r.jsxs)(n.h4,{id:"update_finishedsource",children:["update_finished()",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/decode_strategy.py#L329-L336",children:"[source]"})]}),"\n",(0,r.jsxs)(n.p,{children:["DecodeStrategy subclasses should override ",(0,r.jsx)(n.a,{href:"#eole.predict.DecodeStrategy.update_finished",children:(0,r.jsx)(n.code,{children:"update_finished()"})}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"update_finished"})," is used to update ",(0,r.jsx)(n.code,{children:"self.predictions"}),",\n",(0,r.jsx)(n.code,{children:"self.scores"}),", and other \u201coutput\u201d attributes."]}),"\n",(0,r.jsxs)(n.h3,{id:"class-eolepredictbeamsearchbeam_size-batch_size-pad-bos-eos-unk-start-n_best-global_scorer-min_length-max_length-return_attention-block_ngram_repeat-exclusion_tokens-stepwise_penalty-ratio-ban_unk_token-add_estimatorfalsesource",children:[(0,r.jsx)(n.em,{children:"class"})," eole.predict.BeamSearch(beam_size, batch_size, pad, bos, eos, unk, start, n_best, global_scorer, min_length, max_length, return_attention, block_ngram_repeat, exclusion_tokens, stepwise_penalty, ratio, ban_unk_token, add_estimator=False)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/beam_search.py#L390-L408",children:"[source]"})]}),"\n",(0,r.jsxs)(n.p,{children:["Bases: ",(0,r.jsx)(n.code,{children:"BeamSearchBase"})]}),"\n",(0,r.jsx)(n.p,{children:"Beam search for seq2seq/encoder-decoder models"}),"\n",(0,r.jsxs)(n.h4,{id:"initializeenc_out-src_len-devicenone-target_prefixnonesource",children:["initialize(enc_out, src_len, device=None, target_prefix=None)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/beam_search.py#L395-L408",children:"[source]"})]}),"\n",(0,r.jsx)(n.p,{children:"Initialize for decoding.\nRepeat src objects beam_size times."}),"\n",(0,r.jsxs)(n.h3,{id:"eolepredictgreedy_searchsample_with_temperaturelogits-sampling_temp-keep_topk-keep_toppsource",children:["eole.predict.greedy_search.sample_with_temperature(logits, sampling_temp, keep_topk, keep_topp)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/greedy_search.py#L39-L84",children:"[source]"})]}),"\n",(0,r.jsx)(n.p,{children:"Select next tokens randomly from the top k possible next tokens."}),"\n",(0,r.jsxs)(n.p,{children:["Samples from a categorical distribution over the ",(0,r.jsx)(n.code,{children:"keep_topk"})," words using\nthe category probabilities ",(0,r.jsx)(n.code,{children:"logits / sampling_temp"}),"."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameters:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"logits"})," (",(0,r.jsx)(n.em,{children:"FloatTensor"}),") \u2013 Shaped ",(0,r.jsx)(n.code,{children:"(batch_size, vocab_size)"}),".\nThese can be logits (",(0,r.jsx)(n.code,{children:"(-inf, inf)"}),") or log-probs (",(0,r.jsx)(n.code,{children:"(-inf, 0]"}),").\n(The distribution actually uses the log-probabilities\n",(0,r.jsx)(n.code,{children:"logits - logits.logsumexp(-1)"}),", which equals the logits if\nthey are log-probabilities summing to 1.)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"sampling_temp"})," (",(0,r.jsx)(n.em,{children:"float"}),") \u2013 Used to scale down logits. The higher the\nvalue, the more likely it is that a non-max word will be\nsampled."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"keep_topk"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 This many words could potentially be chosen. The\nother logits are set to have probability 0."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"keep_topp"})," (",(0,r.jsx)(n.em,{children:"float"}),") \u2013 Keep most likely words until the cumulated\nprobability is greater than p. If used with keep_topk: both\nconditions will be applied"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Returns:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["topk_ids: Shaped ",(0,r.jsx)(n.code,{children:"(batch_size, 1)"}),". These are\nthe sampled word indices in the output vocab."]}),"\n",(0,r.jsxs)(n.li,{children:["topk_scores: Shaped ",(0,r.jsx)(n.code,{children:"(batch_size, 1)"}),". These\nare essentially ",(0,r.jsx)(n.code,{children:"(logits / sampling_temp)[topk_ids]"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Return type:"}),"\n(LongTensor, FloatTensor)"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"class-eolepredictgreedysearchpad-bos-eos-unk-start-n_best-batch_size-global_scorer-min_length-block_ngram_repeat-exclusion_tokens-return_attention-max_length-sampling_temp-keep_topk-keep_topp-beam_size-ban_unk_token-add_estimatorfalsesource",children:[(0,r.jsx)(n.em,{children:"class"})," eole.predict.GreedySearch(pad, bos, eos, unk, start, n_best, batch_size, global_scorer, min_length, block_ngram_repeat, exclusion_tokens, return_attention, max_length, sampling_temp, keep_topk, keep_topp, beam_size, ban_unk_token, add_estimator=False)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/greedy_search.py#L87-L292",children:"[source]"})]}),"\n",(0,r.jsxs)(n.p,{children:["Bases: ",(0,r.jsx)(n.a,{href:"#eole.predict.DecodeStrategy",children:(0,r.jsx)(n.code,{children:"DecodeStrategy"})})]}),"\n",(0,r.jsx)(n.p,{children:"Select next tokens randomly from the top k possible next tokens."}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"scores"})," attribute\u2019s lists are the score, after applying temperature,\nof the final prediction (either EOS or the final token in the event\nthat ",(0,r.jsx)(n.code,{children:"max_length"})," is reached)"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameters:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"pad"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See base."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"bos"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See base."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"eos"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See base."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"unk"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See base."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"start"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See base."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"n_best"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 Don\u2019t stop until at least this many beams have\nreached EOS."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"batch_size"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See base."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"global_scorer"})," (",(0,r.jsx)(n.a,{href:"#eole.predict.GNMTGlobalScorer",children:(0,r.jsx)(n.em,{children:"eole.predict.GNMTGlobalScorer"})}),") \u2013 Scorer instance."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"min_length"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See base."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"max_length"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See base."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ban_unk_token"})," (",(0,r.jsx)(n.em,{children:"Boolean"}),") \u2013 See base."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"block_ngram_repeat"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See base."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"exclusion_tokens"})," (",(0,r.jsx)(n.em,{children:"set"})," *[*",(0,r.jsx)(n.em,{children:"int"})," ",(0,r.jsx)(n.em,{children:"]"}),") \u2013 See base."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"return_attention"})," (",(0,r.jsx)(n.em,{children:"bool"}),") \u2013 See base."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"max_length"})," \u2013 See base."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"sampling_temp"})," (",(0,r.jsx)(n.em,{children:"float"}),") \u2013 See\n",(0,r.jsx)(n.a,{href:"#eole.predict.greedy_search.sample_with_temperature",children:(0,r.jsx)(n.code,{children:"sample_with_temperature()"})}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"keep_topk"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 See\n",(0,r.jsx)(n.a,{href:"#eole.predict.greedy_search.sample_with_temperature",children:(0,r.jsx)(n.code,{children:"sample_with_temperature()"})}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"keep_topp"})," (",(0,r.jsx)(n.em,{children:"float"}),") \u2013 See\n",(0,r.jsx)(n.a,{href:"#eole.predict.greedy_search.sample_with_temperature",children:(0,r.jsx)(n.code,{children:"sample_with_temperature()"})}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"beam_size"})," (",(0,r.jsx)(n.em,{children:"int"}),") \u2013 Number of beams to use."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"advancelog_probs-attnsource-1",children:["advance(log_probs, attn)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/greedy_search.py#L217-L246",children:"[source]"})]}),"\n",(0,r.jsx)(n.p,{children:"Select next tokens randomly from the top k possible next tokens."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameters:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"log_probs"})," (",(0,r.jsx)(n.em,{children:"FloatTensor"}),") \u2013 Shaped ",(0,r.jsx)(n.code,{children:"(batch_size, vocab_size)"}),".\nThese can be logits (",(0,r.jsx)(n.code,{children:"(-inf, inf)"}),") or log-probs\n(",(0,r.jsx)(n.code,{children:"(-inf, 0]"}),"). (The distribution actually uses the\nlog-probabilities ",(0,r.jsx)(n.code,{children:"logits - logits.logsumexp(-1)"}),",\nwhich equals the logits if they are log-probabilities summing\nto 1.)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"attn"})," (",(0,r.jsx)(n.em,{children:"FloatTensor"}),") \u2013 Shaped ",(0,r.jsx)(n.code,{children:"(1, B, inp_seq_len)"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"initializeenc_out-src_len-devicenone-target_prefixnonesource-1",children:["initialize(enc_out, src_len, device=None, target_prefix=None)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/greedy_search.py#L166-L184",children:"[source]"})]}),"\n",(0,r.jsx)(n.p,{children:"Initialize for decoding."}),"\n",(0,r.jsxs)(n.h4,{id:"update_finishedsource-1",children:["update_finished()",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/greedy_search.py#L248-L292",children:"[source]"})]}),"\n",(0,r.jsx)(n.p,{children:"Finalize scores and predictions."}),"\n",(0,r.jsx)(n.h2,{id:"scoring",children:"Scoring"}),"\n",(0,r.jsxs)(n.h3,{id:"class-eolepredictpenaltiespenaltybuildercov_pen-length_pensource",children:[(0,r.jsx)(n.em,{children:"class"})," eole.predict.penalties.PenaltyBuilder(cov_pen, length_pen)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/penalties.py#L4-L98",children:"[source]"})]}),"\n",(0,r.jsxs)(n.p,{children:["Bases: ",(0,r.jsx)(n.code,{children:"object"})]}),"\n",(0,r.jsx)(n.p,{children:"Returns the Length and Coverage Penalty function for Beam Search."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameters:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"length_pen"})," (",(0,r.jsx)(n.em,{children:"str"}),") \u2013 option name of length pen"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"cov_pen"})," (",(0,r.jsx)(n.em,{children:"str"}),") \u2013 option name of cov pen"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Variables:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"has_cov_pen"})," (",(0,r.jsx)(n.em,{children:"bool"}),") \u2013 Whether coverage penalty is None (applying it\nis a no-op). Note that the converse isn\u2019t true. Setting beta\nto 0 should force coverage length to be a no-op."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"has_len_pen"})," (",(0,r.jsx)(n.em,{children:"bool"}),") \u2013 Whether length penalty is None (applying it\nis a no-op). Note that the converse isn\u2019t true. Setting alpha\nto 1 should force length penalty to be a no-op."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"coverage_penalty"})," (",(0,r.jsx)(n.em,{children:"callable"})," ",(0,r.jsx)(n.em,{children:"["})," *[*",(0,r.jsx)(n.em,{children:"FloatTensor"})," ",(0,r.jsx)(n.em,{children:","})," ",(0,r.jsx)(n.em,{children:"float"})," ",(0,r.jsx)(n.em,{children:"]"})," ",(0,r.jsx)(n.em,{children:","})," ",(0,r.jsx)(n.em,{children:"FloatTensor"})," ",(0,r.jsx)(n.em,{children:"]"}),") \u2013 Calculates the coverage penalty."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"length_penalty"})," (",(0,r.jsx)(n.em,{children:"callable"})," ",(0,r.jsx)(n.em,{children:"["})," *[*",(0,r.jsx)(n.em,{children:"int"})," ",(0,r.jsx)(n.em,{children:","})," ",(0,r.jsx)(n.em,{children:"float"})," ",(0,r.jsx)(n.em,{children:"]"})," ",(0,r.jsx)(n.em,{children:","})," ",(0,r.jsx)(n.em,{children:"float"})," ",(0,r.jsx)(n.em,{children:"]"}),") \u2013 Calculates\nthe length penalty."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.h4,{id:"coverage_nonecov-beta00source",children:["coverage_none(cov, beta=0.0)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/penalties.py#L77-L82",children:"[source]"})]}),"\n",(0,r.jsx)(n.p,{children:"Returns zero as penalty"}),"\n",(0,r.jsxs)(n.h4,{id:"coverage_summarycov-beta00source",children:["coverage_summary(cov, beta=0.0)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/penalties.py#L71-L75",children:"[source]"})]}),"\n",(0,r.jsx)(n.p,{children:"Our summary penalty."}),"\n",(0,r.jsxs)(n.h4,{id:"coverage_wucov-beta00source",children:["coverage_wu(cov, beta=0.0)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/penalties.py#L58-L69",children:"[source]"})]}),"\n",(0,r.jsx)(n.p,{children:"GNMT coverage re-ranking score."}),"\n",(0,r.jsxs)(n.p,{children:["See \u201cGoogle\u2019s Neural Machine Translation System\u201d [].\n",(0,r.jsx)(n.code,{children:"cov"})," is expected to be sized ",(0,r.jsx)(n.code,{children:"(*, seq_len)"}),", where ",(0,r.jsx)(n.code,{children:"*"})," is\nprobably ",(0,r.jsx)(n.code,{children:"batch_size x beam_size"})," but could be several\ndimensions like ",(0,r.jsx)(n.code,{children:"(batch_size, beam_size)"}),". If ",(0,r.jsx)(n.code,{children:"cov"})," is attention,\nthen the ",(0,r.jsx)(n.code,{children:"seq_len"})," axis probably sums to (almost) 1."]}),"\n",(0,r.jsxs)(n.h4,{id:"length_averagecur_len-alpha10source",children:["length_average(cur_len, alpha=1.0)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/penalties.py#L92-L94",children:"[source]"})]}),"\n",(0,r.jsx)(n.p,{children:"Returns the current sequence length."}),"\n",(0,r.jsxs)(n.h4,{id:"length_nonecur_len-alpha00source",children:["length_none(cur_len, alpha=0.0)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/penalties.py#L96-L98",children:"[source]"})]}),"\n",(0,r.jsx)(n.p,{children:"Returns unmodified scores."}),"\n",(0,r.jsxs)(n.h4,{id:"length_wucur_len-alpha00source",children:["length_wu(cur_len, alpha=0.0)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/penalties.py#L84-L90",children:"[source]"})]}),"\n",(0,r.jsx)(n.p,{children:"GNMT length re-ranking score."}),"\n",(0,r.jsx)(n.p,{children:"See \u201cGoogle\u2019s Neural Machine Translation System\u201d []."}),"\n",(0,r.jsxs)(n.h3,{id:"class-eolepredictgnmtglobalscoreralpha-beta-length_penalty-coverage_penaltysource",children:[(0,r.jsx)(n.em,{children:"class"})," eole.predict.GNMTGlobalScorer(alpha, beta, length_penalty, coverage_penalty)",(0,r.jsx)(n.a,{href:"https://github.com/eole-nlp/eole/blob/master/eole/predict/beam_search.py#L442-L501",children:"[source]"})]}),"\n",(0,r.jsxs)(n.p,{children:["Bases: ",(0,r.jsx)(n.code,{children:"object"})]}),"\n",(0,r.jsx)(n.p,{children:"NMT re-ranking."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameters:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"alpha"})," (",(0,r.jsx)(n.em,{children:"float"}),") \u2013 Length parameter."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"beta"})," (",(0,r.jsx)(n.em,{children:"float"}),") \u2013 Coverage parameter."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"length_penalty"})," (",(0,r.jsx)(n.em,{children:"str"}),") \u2013 Length penalty strategy."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"coverage_penalty"})," (",(0,r.jsx)(n.em,{children:"str"}),") \u2013 Coverage penalty strategy."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Variables:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"alpha"})," (",(0,r.jsx)(n.em,{children:"float"}),") \u2013 See above."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"beta"})," (",(0,r.jsx)(n.em,{children:"float"}),") \u2013 See above."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"length_penalty"})," (",(0,r.jsx)(n.em,{children:"callable"}),") \u2013 See ",(0,r.jsx)(n.a,{href:"#eole.predict.penalties.PenaltyBuilder",children:(0,r.jsx)(n.code,{children:"penalties.PenaltyBuilder"})}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"coverage_penalty"})," (",(0,r.jsx)(n.em,{children:"callable"}),") \u2013 See ",(0,r.jsx)(n.a,{href:"#eole.predict.penalties.PenaltyBuilder",children:(0,r.jsx)(n.code,{children:"penalties.PenaltyBuilder"})}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"has_cov_pen"})," (",(0,r.jsx)(n.em,{children:"bool"}),") \u2013 See ",(0,r.jsx)(n.a,{href:"#eole.predict.penalties.PenaltyBuilder",children:(0,r.jsx)(n.code,{children:"penalties.PenaltyBuilder"})}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"has_len_pen"})," (",(0,r.jsx)(n.em,{children:"bool"}),") \u2013 See ",(0,r.jsx)(n.a,{href:"#eole.predict.penalties.PenaltyBuilder",children:(0,r.jsx)(n.code,{children:"penalties.PenaltyBuilder"})}),"."]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>o});var r=s(6540);const l={},t=r.createContext(l);function i(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);